<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Informasi Persediaan ATK - PA Penajam</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/2.0.8/css/dataTables.bootstrap5.min.css" rel="stylesheet">

    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

    <style>
        body {
            background-color: #f8f9fa;
        }

        #app-main {
            display: flex;
            min-height: 100vh;
        }

        #sidebar {
            width: 250px;
            background: #343a40;
            color: white;
            transition: all 0.3s;
        }

        #sidebar .nav-link {
            color: #adb5bd;
            transition: all 0.3s;
        }

        #sidebar .nav-link:hover,
        #sidebar .nav-link.active {
            color: #ffffff;
            background-color: #495057;
        }

        #content {
            flex-grow: 1;
            padding: 2rem;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        #login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-card {
            width: 100%;
            max-width: 400px;
        }

        .dataTables_wrapper .row {
            margin-bottom: 1rem;
        }
    </style>
</head>

<body>

    <!-- ===================================================================== -->
    <!-- HALAMAN LOGIN                                                         -->
    <!-- ===================================================================== -->
    <div id="login-page">
        <div class="card shadow-lg border-0 rounded-lg login-card">
            <div class="card-body p-5 text-center">
                <i class="bi bi-box-seam-fill fs-1 text-primary mb-4"></i>
                <h3 class="card-title mb-3">Sistem Persediaan ATK</h3>
                <p class="text-muted mb-4">Pengadilan Agama Penajam</p>
                <form id="login-form">
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="username" placeholder="Username" required
                            value="admin">
                        <label for="username">Username</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="password" class="form-control" id="password" placeholder="Password" required
                            value="password">
                        <label for="password">Password</label>
                    </div>
                    <div class="form-floating mb-4">
                        <select class="form-select" id="role">
                            <option value="admin" selected>Admin</option>
                            <option value="pimpinan">Pimpinan (Operator)</option>
                            <option value="pegawai">Pegawai (User)</option>
                        </select>
                        <label for="role">Login Sebagai</label>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 btn-lg">Login</button>
                </form>
            </div>
        </div>
    </div>

    <!-- ===================================================================== -->
    <!-- APLIKASI UTAMA                                                        -->
    <!-- ===================================================================== -->
    <div id="app-main" style="display: none;">
        <!-- Sidebar -->
        <nav id="sidebar" class="d-flex flex-column p-3">
            <div class="text-center mb-4">
                <i class="bi bi-box-seam-fill fs-2"></i>
                <h5 class="mt-2">ATK PA Penajam</h5>
            </div>
            <ul class="nav nav-pills flex-column mb-auto">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-page="dashboard">
                        <i class="bi bi-speedometer2 me-2"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item menu-admin menu-pimpinan menu-pegawai">
                    <a href="#" class="nav-link" data-page="permintaan-barang">
                        <i class="bi bi-file-earmark-text me-2"></i> Permintaan Barang
                    </a>
                </li>
                <li class="nav-item menu-admin">
                    <a href="#" class="nav-link" data-page="barang-masuk">
                        <i class="bi bi-box-arrow-in-down me-2"></i> Barang Masuk
                    </a>
                </li>
                <li class="nav-item menu-admin">
                    <a href="#" class="nav-link" data-page="barang-keluar">
                        <i class="bi bi-box-arrow-up me-2"></i> Barang Keluar
                    </a>
                </li>
                <li class="nav-item menu-admin">
                    <a href="#" class="nav-link" data-page="stok-opname">
                        <i class="bi bi-clipboard-check me-2"></i> Stok Opname
                    </a>
                </li>
                <li class="nav-item menu-admin">
                    <a href="#master-data-submenu" data-bs-toggle="collapse" class="nav-link">
                        <i class="bi bi-database me-2"></i> Master Data
                    </a>
                    <ul class="collapse nav flex-column ms-3" id="master-data-submenu">
                        <li><a href="#" class="nav-link" data-page="data-barang"><i class="bi bi-box me-2"></i>Data
                                Barang</a></li>
                        <li><a href="#" class="nav-link" data-page="data-pengguna"><i class="bi bi-people me-2"></i>Data
                                Pengguna</a></li>
                        <li><a href="#" class="nav-link" data-page="data-kategori"><i class="bi bi-tags me-2"></i>Data
                                Kategori</a></li>
                    </ul>
                </li>
                <li class="nav-item menu-admin menu-pimpinan">
                    <a href="#laporan-submenu" data-bs-toggle="collapse" class="nav-link">
                        <i class="bi bi-file-earmark-bar-graph me-2"></i> Laporan
                    </a>
                    <ul class="collapse nav flex-column ms-3" id="laporan-submenu">
                        <li><a href="#" class="nav-link" id="btn-print-laporan-keluar"><i
                                    class="bi bi-file-pdf me-2"></i>Lap. Barang Keluar</a></li>
                    </ul>
                </li>
            </ul>
            <hr>
            <div class="dropdown">
                <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle"
                    data-bs-toggle="dropdown">
                    <i class="bi bi-person-circle fs-4 me-2"></i>
                    <strong id="user-fullname">Nama Pengguna</strong>
                </a>
                <ul class="dropdown-menu dropdown-menu-dark text-small shadow">
                    <li><a class="dropdown-item" href="#" id="logout-button">Sign out</a></li>
                </ul>
            </div>
        </nav>

        <!-- Content -->
        <main id="content">
            <!-- Halaman Dashboard -->
            <div id="dashboard" class="page active">
                <h1 class="mb-4">Dashboard</h1>
                <div class="row">
                    <div class="col-md-3 mb-4">
                        <div class="card text-white bg-primary">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <div>
                                    <h5 class="card-title">Total Barang</h5>
                                    <p class="card-text fs-3">125</p>
                                </div>
                                <i class="bi bi-box-seam fs-1 opacity-50"></i>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="card text-white bg-warning">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <div>
                                    <h5 class="card-title">Stok Menipis</h5>
                                    <p class="card-text fs-3">8</p>
                                </div>
                                <i class="bi bi-exclamation-triangle fs-1 opacity-50"></i>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="card text-white bg-info">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <div>
                                    <h5 class="card-title">Permintaan Baru</h5>
                                    <p class="card-text fs-3">3</p>
                                </div>
                                <i class="bi bi-file-earmark-text fs-1 opacity-50"></i>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="card text-white bg-success">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <div>
                                    <h5 class="card-title">Total Pengguna</h5>
                                    <p class="card-text fs-3">15</p>
                                </div>
                                <i class="bi bi-people fs-1 opacity-50"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Grafik Penggunaan Barang Bulanan</h5>
                        <canvas id="usageChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Halaman Permintaan Barang -->
            <div id="permintaan-barang" class="page">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h1>Permintaan Barang</h1>
                    <button class="btn btn-primary menu-pegawai" data-bs-toggle="modal"
                        data-bs-target="#permintaanModal"><i class="bi bi-plus-circle me-2"></i>Buat Permintaan</button>
                </div>
                <div class="card">
                    <div class="card-body">
                        <table id="tabelPermintaan" class="table table-striped" style="width:100%">
                            <!-- Data akan diisi oleh JavaScript -->
                        </table>
                    </div>
                </div>
            </div>

            <!-- Halaman Barang Masuk -->
            <div id="barang-masuk" class="page">
                <h1>Barang Masuk</h1>
                <p>Halaman ini digunakan untuk menginput data barang yang diterima dari pemasok.</p>
                <!-- Form input barang masuk akan ada di sini -->
            </div>

            <!-- Halaman Barang Keluar -->
            <div id="barang-keluar" class="page">
                <h1>Barang Keluar</h1>
                <p>Halaman ini menampilkan daftar permintaan yang disetujui dan siap untuk dikeluarkan.</p>
                <!-- Tabel permintaan disetujui akan ada di sini -->
            </div>

            <!-- Halaman Stok Opname -->
            <div id="stok-opname" class="page">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h1>Stok Opname</h1>
                    <div>
                        <button class="btn btn-success" id="btn-simpan-opname"><i class="bi bi-save me-2"></i>Simpan
                            Hasil</button>
                        <button class="btn btn-danger" id="btn-print-opname"><i class="bi bi-printer me-2"></i>Print
                            PDF</button>
                    </div>
                </div>
                <div class="card">
                    <div class="card-body">
                        <table id="tabelOpname" class="table table-striped" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Kode Barang</th>
                                    <th>Nama Barang</th>
                                    <th>Stok Sistem</th>
                                    <th>Stok Fisik</th>
                                    <th>Selisih</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Halaman Data Barang -->
            <div id="data-barang" class="page">
                <h1>Master Data Barang</h1>
                <!-- Tabel data barang akan ada di sini -->
            </div>

            <!-- Halaman Data Pengguna -->
            <div id="data-pengguna" class="page">
                <h1>Master Data Pengguna</h1>
                <!-- Tabel data pengguna akan ada di sini -->
            </div>

            <!-- Halaman Data Kategori -->
            <div id="data-kategori" class="page">
                <h1>Master Data Kategori</h1>
                <!-- Tabel data kategori akan ada di sini -->
            </div>
        </main>
    </div>

    <!-- Modal Permintaan Barang -->
    <div class="modal fade" id="permintaanModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Form Permintaan Barang</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="form-permintaan">
                        <div class="mb-3">
                            <label for="catatan_pemohon" class="form-label">Catatan/Keperluan</label>
                            <textarea class="form-control" id="catatan_pemohon" rows="2" required></textarea>
                        </div>
                        <hr>
                        <h6>Item Barang</h6>
                        <div id="item-list">
                            <!-- Baris item akan ditambahkan oleh JavaScript -->
                        </div>
                        <button type="button" class="btn btn-outline-primary btn-sm mt-2" id="add-item-btn"><i
                                class="bi bi-plus"></i> Tambah Item</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" id="submit-permintaan">Ajukan Permintaan</button>
                </div>
            </div>
        </div>
    </div>


    <!-- ===================================================================== -->
    <!-- JAVASCRIPT LIBRARIES                                                  -->
    <!-- ===================================================================== -->
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.bootstrap5.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- jsPDF and autoTable plugin for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

    <!-- ===================================================================== -->
    <!-- APLIKASI JAVASCRIPT UTAMA                                             -->
    <!-- ===================================================================== -->
    <script>
        $(document).ready(function () {

            // =====================================================================
            // DATA SIMULASI (Harusnya dari Database PHP)
            // =====================================================================
            const mockDataBarang = [
                { id: 1, kode: 'ATK-KRT-001', nama: 'Kertas HVS A4 80gr', stok: 50, satuan: 'Rim' },
                { id: 2, kode: 'ATK-ALT-001', nama: 'Pulpen Pilot G2', stok: 120, satuan: 'Pcs' },
                { id: 3, kode: 'ATK-MAP-001', nama: 'Map Snelhecter Biru', stok: 75, satuan: 'Pcs' },
                { id: 4, kode: 'ATK-TNR-001', nama: 'Toner HP LaserJet 85A', stok: 10, satuan: 'Unit' },
                { id: 5, kode: 'ATK-ALT-002', nama: 'Spidol Snowman Boardmarker', stok: 45, satuan: 'Pcs' },
            ];

            const mockDataPermintaan = [
                { id: 1, kode: 'REQ/2025/08/001', pemohon: 'Pegawai A', tanggal: '2025-08-22', status: 'Disetujui' },
                { id: 2, kode: 'REQ/2025/08/002', pemohon: 'Pegawai B', tanggal: '2025-08-23', status: 'Diajukan' },
                { id: 3, kode: 'REQ/2025/08/003', pemohon: 'Pegawai C', tanggal: '2025-08-23', status: 'Ditolak' },
                { id: 4, kode: 'REQ/2025/08/004', pemohon: 'Pegawai D', tanggal: '2025-08-24', status: 'Selesai' },
            ];

            // =====================================================================
            // LOGIKA LOGIN & AUTENTIKASI
            // =====================================================================
            $('#login-form').on('submit', function (e) {
                e.preventDefault();
                const role = $('#role').val();
                const username = $('#username').val();

            /*
            <?php

            // PROSES LOGIN PHP (AJAX)
            // 1. Ambil username, password, role dari POST
            // 2. Query ke tbl_pengguna WHERE username = ?
            // 3. Jika user ada, verifikasi password dengan password_verify()
            // 4. Jika password cocok, buat session:
            //    $_SESSION['user_id'] = $user['id_pengguna'];
            //    $_SESSION['nama_lengkap'] = $user['nama_lengkap'];
            //    $_SESSION['role'] = $user['role'];
            // 5. Kirim response JSON success
            // 6. Jika gagal, kirim response JSON error
            ?>
            */

                // Simulasi login berhasil
                Swal.fire({
                    icon: 'success',
                    title: 'Login Berhasil!',
                    text: `Selamat datang, ${username}!`,
                    timer: 1500,
                    showConfirmButton: false
                }).then(() => {
                    $('#login-page').hide();
                    $('#app-main').show();
                    setupUIForRole(role, username);
                    navigateTo('dashboard'); // Arahkan ke dashboard setelah login
                });
            });

            $('#logout-button').on('click', function (e) {
                e.preventDefault();
            /*
            <?php

            // PROSES LOGOUT PHP
            // session_start();
            // session_destroy();
            // header('Location: login.php');
            ?>
            */
                // Simulasi logout
                Swal.fire({
                    title: 'Anda yakin ingin keluar?',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Ya, keluar!'
                }).then((result) => {
                    if (result.isConfirmed) {
                        location.reload();
                    }
                });
            });

            function setupUIForRole(role, username) {
                $('#user-fullname').text(username);
                // Sembunyikan semua menu dulu
                $('#sidebar .nav-item[class*="menu-"]').hide();
                // Tampilkan menu sesuai role
                $(`.menu-${role}`).show();
            }

            // =====================================================================
            // NAVIGASI SPA (Single Page Application)
            // =====================================================================
            $('.nav-link').on('click', function (e) {
                e.preventDefault();
                const pageId = $(this).data('page');
                if (pageId) {
                    navigateTo(pageId);
                    $('.nav-link').removeClass('active');
                    $(this).addClass('active');
                }
            });

            function navigateTo(pageId) {
                $('.page').removeClass('active');
                $('#' + pageId).addClass('active');
                // Inisialisasi konten halaman saat navigasi
                if (pageId === 'dashboard' && !$.fn.DataTable.isDataTable('#tabelDashboard')) {
                    initDashboard();
                } else if (pageId === 'permintaan-barang' && !$.fn.DataTable.isDataTable('#tabelPermintaan')) {
                    initTabelPermintaan();
                } else if (pageId === 'stok-opname' && !$.fn.DataTable.isDataTable('#tabelOpname')) {
                    initTabelOpname();
                }
            }

            // =====================================================================
            // INISIALISASI HALAMAN
            // =====================================================================

            // --- Dashboard ---
            function initDashboard() {
                const ctx = document.getElementById('usageChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun'],
                        datasets: [{
                            label: 'Jumlah Barang Keluar',
                            data: [65, 59, 80, 81, 56, 55],
                            backgroundColor: 'rgba(54, 162, 235, 0.5)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // --- Permintaan Barang ---
            function initTabelPermintaan() {
                const role = $('#role').val(); // Ambil role saat ini
                let columns = [
                    { data: 'kode', title: 'Kode Permintaan' },
                    { data: 'pemohon', title: 'Pemohon' },
                    { data: 'tanggal', title: 'Tanggal' },
                    {
                        data: 'status',
                        title: 'Status',
                        render: function (data) {
                            let badgeClass = 'bg-secondary';
                            if (data === 'Disetujui') badgeClass = 'bg-success';
                            if (data === 'Ditolak') badgeClass = 'bg-danger';
                            if (data === 'Diajukan') badgeClass = 'bg-warning';
                            if (data === 'Selesai') badgeClass = 'bg-info';
                            return `<span class="badge ${badgeClass}">${data}</span>`;
                        }
                    },
                    {
                        data: null,
                        title: 'Aksi',
                        render: function (data, type, row) {
                            let buttons = '<button class="btn btn-sm btn-info me-1" title="Lihat Detail"><i class="bi bi-eye"></i></button>';
                            if (role === 'pimpinan' && row.status === 'Diajukan') {
                                buttons += '<button class="btn btn-sm btn-success me-1" title="Setujui"><i class="bi bi-check-lg"></i></button>';
                                buttons += '<button class="btn btn-sm btn-danger" title="Tolak"><i class="bi bi-x-lg"></i></button>';
                            }
                            return buttons;
                        }
                    }
                ];

                $('#tabelPermintaan').DataTable({
                    data: mockDataPermintaan,
                    columns: columns,
                    responsive: true
                });
            }

            // --- Stok Opname ---
            function initTabelOpname() {
                const dataOpname = mockDataBarang.map(item => ({
                    ...item,
                    stok_fisik: item.stok,
                    selisih: 0
                }));

                const table = $('#tabelOpname').DataTable({
                    data: dataOpname,
                    columns: [
                        { data: 'kode', title: 'Kode Barang' },
                        { data: 'nama', title: 'Nama Barang' },
                        { data: 'stok', title: 'Stok Sistem' },
                        {
                            data: 'stok_fisik',
                            title: 'Stok Fisik',
                            render: function (data, type, row) {
                                return `<input type="number" class="form-control form-control-sm stok-fisik-input" value="${data}" data-id="${row.id}" style="width: 80px;">`;
                            }
                        },
                        {
                            data: 'selisih',
                            title: 'Selisih',
                            render: function (data, type, row) {
                                return `<span class="selisih-text" data-id="${row.id}">${data}</span>`;
                            }
                        }
                    ],
                    paging: false,
                    searching: false,
                    info: false
                });

                $('#tabelOpname tbody').on('change', '.stok-fisik-input', function () {
                    const id = $(this).data('id');
                    const stokFisik = parseInt($(this).val());
                    const row = table.rows().data().toArray().find(r => r.id === id);
                    if (row) {
                        const selisih = stokFisik - row.stok;
                        $(`.selisih-text[data-id="${id}"]`).text(selisih).css('color', selisih < 0 ? 'red' : 'green');
                    }
                });
            }


            // =====================================================================
            // FUNGSI MODAL PERMINTAAN
            // =====================================================================
            function addItemRow() {
                const itemOptions = mockDataBarang.map(item => `<option value="${item.id}">${item.kode} - ${item.nama}</option>`).join('');
                const newRow = `
                <div class="row item-row mb-2">
                    <div class="col-md-6">
                        <select class="form-select" required>${itemOptions}</select>
                    </div>
                    <div class="col-md-4">
                        <input type="number" class="form-control" placeholder="Jumlah" required min="1">
                    </div>
                    <div class="col-md-2">
                        <button type="button" class="btn btn-danger remove-item-btn"><i class="bi bi-trash"></i></button>
                    </div>
                </div>`;
                $('#item-list').append(newRow);
            }

            $('#add-item-btn').on('click', addItemRow);
            $('#item-list').on('click', '.remove-item-btn', function () {
                $(this).closest('.item-row').remove();
            });

            // Tambah baris pertama saat modal dibuka
            $('#permintaanModal').on('shown.bs.modal', function () {
                if ($('#item-list .item-row').length === 0) {
                    addItemRow();
                }
            });

            $('#submit-permintaan').on('click', function () {
                // Logika untuk mengirim data form ke server via AJAX
                Swal.fire('Berhasil!', 'Permintaan Anda telah diajukan.', 'success');
                $('#permintaanModal').modal('hide');
            });


            // =====================================================================
            // FUNGSI PRINT PDF
            // =====================================================================

            // --- Print Stok Opname ---
            $('#btn-print-opname').on('click', function () {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                doc.setFontSize(18);
                doc.text("Laporan Hasil Stok Opname", 14, 22);
                doc.setFontSize(11);
                doc.setTextColor(100);
                doc.text(`Tanggal: ${new Date().toLocaleDateString('id-ID')}`, 14, 30);

                const tableData = [];
                $('#tabelOpname tbody tr').each(function () {
                    const row = [];
                    $(this).find('td').each(function (index) {
                        if (index === 3) { // Kolom Stok Fisik
                            row.push($(this).find('input').val());
                        } else {
                            row.push($(this).text());
                        }
                    });
                    tableData.push(row);
                });

                doc.autoTable({
                    head: [['Kode Barang', 'Nama Barang', 'Stok Sistem', 'Stok Fisik', 'Selisih']],
                    body: tableData,
                    startY: 35,
                    theme: 'grid'
                });

                doc.save('laporan-stok-opname.pdf');
            });

            // --- Print Laporan Barang Keluar ---
            $('#btn-print-laporan-keluar').on('click', function () {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                doc.setFontSize(18);
                doc.text("Laporan Persediaan Keluar", 14, 22);
                doc.setFontSize(11);
                doc.text("Periode: 1 Agustus 2025 - 31 Agustus 2025", 14, 30);

                // Data simulasi untuk laporan barang keluar
                const dataLaporanKeluar = [
                    ['2025-08-05', 'REQ/2025/08/001', 'Kertas HVS A4', '5 Rim', 'Pegawai A', 'Kepaniteraan'],
                    ['2025-08-07', 'REQ/2025/08/004', 'Pulpen Pilot G2', '12 Pcs', 'Pegawai D', 'Kesekretariatan'],
                    ['2025-08-12', 'REQ/2025/08/009', 'Map Snelhecter', '20 Pcs', 'Pegawai B', 'Umum dan Keuangan'],
                ];

                doc.autoTable({
                    head: [['Tanggal Keluar', 'Kode Permintaan', 'Nama Barang', 'Jumlah', 'Penerima', 'Bagian']],
                    body: dataLaporanKeluar,
                    startY: 35,
                    theme: 'striped'
                });

                doc.save('laporan-barang-keluar.pdf');
            });


            // Inisialisasi halaman awal
            // Cek dulu apakah user sudah login (simulasi)
            // Jika tidak, tampilkan #login-page
            // Jika ya, tampilkan #app-main
        });
    </script>
</body>

</html>